[2025-12-11 00:17:16] ============================================
[2025-12-11 00:17:16] Iniciando scraping paralelo di√°rio
[2025-12-11 00:17:16] ============================================
[2025-12-11 00:17:16] Venv ativado com sucesso
[2025-12-11 00:17:16] Navegado para /home/vivaservicesai/htdocs/app
[2025-12-11 00:17:16] Executando: python3 utils/scraping_parallel.py daily 2
INICIANDO SCRAPING PARALELO (DAILY) - Max Workers: 2
================================================================================
Encontradas 4 contas para processar:
  - Redbull (Username: redbull_34326546457657658658568658657567657567567567567)
  - ABI Brasil (Username: abib_493)
  - Sorocaba Refrescos (Username: sorocaba_215)
  - Fogel de Centroamerica, S.A. (Username: fgl_426)

Iniciando processamento paralelo...

================================================================================
PROCESSANDO CLIENTE (DADOS DI√ÅRIOS): Redbull (Username: redbull_34326546457657658658568658657567657567567567567)
================================================================================
Passo 1: Fazendo GET inicial para estabelecer sessao para redbull_34326546457657658658568658657567657567567567567...

================================================================================
PROCESSANDO CLIENTE (DADOS DI√ÅRIOS): ABI Brasil (Username: abib_493)
================================================================================
Passo 1: Fazendo GET inicial para estabelecer sessao para abib_493...
GET Status: 200

Passo 2: Fazendo POST com credenciais...
GET Status: 200

Passo 2: Fazendo POST com credenciais...
Login Status: 401
Sessao existente detectada. Terminando sessao anterior...
Login Status: 302
OK - Login bem-sucedido! Seguindo redirect...
Terminate Session Status: 200
OK - Sessao anterior terminada!
Cookies apos terminar sessao:
  ASP.NET_SessionId

Fazendo login apos terminar sessao existente...
Login Status (2a tentativa): 401
ERRO - Falha no login apos terminar sessao
Default Page Status: 200
Login realizado com sucesso para ABI Brasil

Buscando registros de sa√∫de para ABI Brasil...

============================================================
Exportando registros de sa√∫de dos dispositivos...
============================================================
Per√≠odo: 12/09/2025 at√© 12/12/2025
Enviando requisi√ß√£o para: https://portal.visioniot.net/Controllers/SmartDeviceHealthRecord.ashx?v=Fri%20Dec%2012%202025%2000%3A00%3A00%20GMT%20%28Brasilia%20Standard%20Time%29
Tamanho do payload: 9754 caracteres
Default Page Status: 200
Login realizado com sucesso para Redbull

Buscando registros de sa√∫de para Redbull...

============================================================
Exportando registros de sa√∫de dos dispositivos...
============================================================
Per√≠odo: 12/09/2025 at√© 12/12/2025
Enviando requisi√ß√£o para: https://portal.visioniot.net/Controllers/SmartDeviceHealthRecord.ashx?v=Fri%20Dec%2012%202025%2000%3A00%3A00%20GMT%20%28Brasilia%20Standard%20Time%29
Tamanho do payload: 9754 caracteres

Status: 200
OK - Requisicao bem-sucedida!

OK - Arquivo XLSX salvo: docs/health_events.xlsx
Tamanho: 101 bytes
OK - Arquivo verificado e salvo com sucesso!
OK - Arquivo de sa√∫de salvo: docs/Redbull_health_events.xlsx

Buscando registros de movimento para Redbull...

============================================================
Exportando registros de movimento dos dispositivos...
============================================================
Periodo: 12/09/2025 ate 12/12/2025
Enviando requisi√ß√£o para: https://portal.visioniot.net/Controllers/SmartDeviceMovement.ashx?v=Fri%20Dec%2012%202025%2000%3A00%3A00%20GMT%20%28Brasilia%20Standard%20Time%29
Tamanho do payload: 6447 caracteres

Status: 200
OK - Requisicao bem-sucedida!

OK - Arquivo XLSX salvo: docs/movements.xlsx
Tamanho: 101 bytes
OK - Arquivo verificado e salvo com sucesso!
OK - Arquivo de movimento salvo: docs/Redbull_movements.xlsx

Buscando alerts para Redbull...

============================================================
Exportando dados de Alerts...
============================================================
Per√≠odo: 12/09/2025 at√© 12/12/2025
Enviando requisi√ß√£o para: https://portal.visioniot.net/Controllers/Alert.ashx?v=Fri%20Dec%2012%202025%2000%3A00%3A00%20GMT%20%28Brasilia%20Standard%20Time%29
Tamanho do payload: 6561 caracteres

Status: 200
OK - Requisi√ß√£o bem-sucedida!

OK - Arquivo XLSX salvo: docs/alerts.xlsx
Tamanho: 101 bytes
OK - Arquivo verificado e salvo com sucesso!
OK - Arquivo de alerts salvo: docs/Redbull_alerts.xlsx

Buscando door statuses para Redbull...

============================================================
Exportando dados de Door Statuses...
============================================================
Per√≠odo: 12/09/2025 at√© 12/12/2025
Enviando requisi√ß√£o para: https://portal.visioniot.net/Controllers/SmartDeviceDoorStatus.ashx?v=Fri%20Dec%2012%202025%2000%3A00%3A00%20GMT%20%28Brasilia%20Standard%20Time%29
Tamanho do payload: 6933 caracteres

Status: 200
OK - Requisi√ß√£o bem-sucedida!

OK - Arquivo CSV salvo: docs/door_statuses.csv
Tamanho: 101 bytes
OK - Arquivo verificado e salvo com sucesso!
OK - Arquivo de door statuses salvo: docs/Redbull_door_statuses.csv

Buscando users para Redbull...

============================================================
Exportando dados de Users...
============================================================
Enviando requisi√ß√£o para: https://portal.visioniot.net/Controllers/SecurityAppUser.ashx?v=Thu%20Dec%2011%202025%2000%3A17%3A21%20GMT%20%28Brasilia%20Standard%20Time%29
Tamanho do payload: 4663 caracteres

Status: 200
OK - Requisi√ß√£o bem-sucedida!

OK - Arquivo XLSX salvo: docs/users.xlsx
Tamanho: 101 bytes
OK - Arquivo verificado e salvo com sucesso!
OK - Arquivo de users salvo: docs/Redbull_users.xlsx

Fazendo logout de Redbull...

============================================================
Fazendo logout...
============================================================
Nenhuma sessao ativa detectada (sem cookie .ASPXAUTH)
Limpando cookies locais...
OK - Cookies limpos

============================================================
DOWNLOAD DI√ÅRIO COMPLETO - Redbull
============================================================
Health Events: docs/Redbull_health_events.xlsx
Movements: docs/Redbull_movements.xlsx
Alerts: docs/Redbull_alerts.xlsx
Door Statuses: docs/Redbull_door_statuses.csv
Users: docs/Redbull_users.xlsx

Todos os dados di√°rios de Redbull foram baixados com sucesso!
Para inserir no banco de dados, execute: python3 import_all_data.py

================================================================================
PROCESSANDO CLIENTE (DADOS DI√ÅRIOS): Sorocaba Refrescos (Username: sorocaba_215)
================================================================================
Passo 1: Fazendo GET inicial para estabelecer sessao para sorocaba_215...

>>> CONCLUS√ÉO: Redbull finalizado com SUCESSO
GET Status: 200

Passo 2: Fazendo POST com credenciais...

Status: 200
OK - Requisicao bem-sucedida!

OK - Arquivo XLSX salvo: docs/health_events.xlsx
Tamanho: 111989 bytes
OK - Arquivo verificado e salvo com sucesso!
OK - Arquivo de sa√∫de salvo: docs/ABI_Brasil_health_events.xlsx

Buscando registros de movimento para ABI Brasil...

============================================================
Exportando registros de movimento dos dispositivos...
============================================================
Periodo: 12/09/2025 ate 12/12/2025
Enviando requisi√ß√£o para: https://portal.visioniot.net/Controllers/SmartDeviceMovement.ashx?v=Fri%20Dec%2012%202025%2000%3A00%3A00%20GMT%20%28Brasilia%20Standard%20Time%29
Tamanho do payload: 6447 caracteres
Login Status: 302
OK - Login bem-sucedido! Seguindo redirect...
Default Page Status: 200
Login realizado com sucesso para Sorocaba Refrescos

Buscando registros de sa√∫de para Sorocaba Refrescos...

============================================================
Exportando registros de sa√∫de dos dispositivos...
============================================================
Per√≠odo: 12/09/2025 at√© 12/12/2025
Enviando requisi√ß√£o para: https://portal.visioniot.net/Controllers/SmartDeviceHealthRecord.ashx?v=Fri%20Dec%2012%202025%2000%3A00%3A00%20GMT%20%28Brasilia%20Standard%20Time%29
Tamanho do payload: 9754 caracteres

Status: 200
OK - Requisicao bem-sucedida!

OK - Arquivo XLSX salvo: docs/health_events.xlsx
Tamanho: 932870 bytes
OK - Arquivo verificado e salvo com sucesso!
OK - Arquivo de sa√∫de salvo: docs/Sorocaba_Refrescos_health_events.xlsx

Buscando registros de movimento para Sorocaba Refrescos...

============================================================
Exportando registros de movimento dos dispositivos...
============================================================
Periodo: 12/09/2025 ate 12/12/2025
Enviando requisi√ß√£o para: https://portal.visioniot.net/Controllers/SmartDeviceMovement.ashx?v=Fri%20Dec%2012%202025%2000%3A00%3A00%20GMT%20%28Brasilia%20Standard%20Time%29
Tamanho do payload: 6447 caracteres

Status: 200
OK - Requisicao bem-sucedida!

OK - Arquivo XLSX salvo: docs/movements.xlsx
Tamanho: 303639 bytes
OK - Arquivo verificado e salvo com sucesso!
OK - Arquivo de movimento salvo: docs/ABI_Brasil_movements.xlsx

Buscando alerts para ABI Brasil...

============================================================
Exportando dados de Alerts...
============================================================
Per√≠odo: 12/09/2025 at√© 12/12/2025
Enviando requisi√ß√£o para: https://portal.visioniot.net/Controllers/Alert.ashx?v=Fri%20Dec%2012%202025%2000%3A00%3A00%20GMT%20%28Brasilia%20Standard%20Time%29
Tamanho do payload: 6561 caracteres

Status: 200
OK - Requisicao bem-sucedida!

OK - Arquivo XLSX salvo: docs/movements.xlsx
Tamanho: 899055 bytes
OK - Arquivo verificado e salvo com sucesso!
OK - Arquivo de movimento salvo: docs/Sorocaba_Refrescos_movements.xlsx

Buscando alerts para Sorocaba Refrescos...

============================================================
Exportando dados de Alerts...
============================================================
Per√≠odo: 12/09/2025 at√© 12/12/2025
Enviando requisi√ß√£o para: https://portal.visioniot.net/Controllers/Alert.ashx?v=Fri%20Dec%2012%202025%2000%3A00%3A00%20GMT%20%28Brasilia%20Standard%20Time%29
Tamanho do payload: 6561 caracteres

Status: 200
OK - Requisi√ß√£o bem-sucedida!

OK - Arquivo XLSX salvo: docs/alerts.xlsx
Tamanho: 7090 bytes
OK - Arquivo verificado e salvo com sucesso!
OK - Arquivo de alerts salvo: docs/ABI_Brasil_alerts.xlsx

Buscando door statuses para ABI Brasil...

============================================================
Exportando dados de Door Statuses...
============================================================
Per√≠odo: 12/09/2025 at√© 12/12/2025
Enviando requisi√ß√£o para: https://portal.visioniot.net/Controllers/SmartDeviceDoorStatus.ashx?v=Fri%20Dec%2012%202025%2000%3A00%3A00%20GMT%20%28Brasilia%20Standard%20Time%29
Tamanho do payload: 6933 caracteres

Status: 200
OK - Requisi√ß√£o bem-sucedida!

OK - Arquivo XLSX salvo: docs/alerts.xlsx
Tamanho: 11292 bytes
OK - Arquivo verificado e salvo com sucesso!
OK - Arquivo de alerts salvo: docs/Sorocaba_Refrescos_alerts.xlsx

Buscando door statuses para Sorocaba Refrescos...

============================================================
Exportando dados de Door Statuses...
============================================================
Per√≠odo: 12/09/2025 at√© 12/12/2025
Enviando requisi√ß√£o para: https://portal.visioniot.net/Controllers/SmartDeviceDoorStatus.ashx?v=Fri%20Dec%2012%202025%2000%3A00%3A00%20GMT%20%28Brasilia%20Standard%20Time%29
Tamanho do payload: 6933 caracteres

Status: 200
OK - Requisi√ß√£o bem-sucedida!

OK - Arquivo CSV salvo: docs/door_statuses.csv
Tamanho: 462248 bytes
OK - Arquivo verificado e salvo com sucesso!
OK - Arquivo de door statuses salvo: docs/ABI_Brasil_door_statuses.csv

Buscando users para ABI Brasil...

============================================================
Exportando dados de Users...
============================================================
Enviando requisi√ß√£o para: https://portal.visioniot.net/Controllers/SecurityAppUser.ashx?v=Thu%20Dec%2011%202025%2000%3A18%3A02%20GMT%20%28Brasilia%20Standard%20Time%29
Tamanho do payload: 4663 caracteres

Status: 200
OK - Requisi√ß√£o bem-sucedida!

OK - Arquivo XLSX salvo: docs/users.xlsx
Tamanho: 536380 bytes
OK - Arquivo verificado e salvo com sucesso!
OK - Arquivo de users salvo: docs/ABI_Brasil_users.xlsx

Fazendo logout de ABI Brasil...

============================================================
Fazendo logout...
============================================================
Status: 200
OK - Logout realizado com sucesso!
OK - Cookies limpos da sessao

============================================================
DOWNLOAD DI√ÅRIO COMPLETO - ABI Brasil
============================================================
Health Events: docs/ABI_Brasil_health_events.xlsx
Movements: docs/ABI_Brasil_movements.xlsx
Alerts: docs/ABI_Brasil_alerts.xlsx
Door Statuses: docs/ABI_Brasil_door_statuses.csv
Users: docs/ABI_Brasil_users.xlsx

Todos os dados di√°rios de ABI Brasil foram baixados com sucesso!
Para inserir no banco de dados, execute: python3 import_all_data.py

================================================================================
PROCESSANDO CLIENTE (DADOS DI√ÅRIOS): Fogel de Centroamerica, S.A. (Username: fgl_426)
================================================================================
Passo 1: Fazendo GET inicial para estabelecer sessao para fgl_426...

>>> CONCLUS√ÉO: ABI Brasil finalizado com SUCESSO
GET Status: 200

Passo 2: Fazendo POST com credenciais...
Login Status: 302
OK - Login bem-sucedido! Seguindo redirect...
Default Page Status: 200
Login realizado com sucesso para Fogel de Centroamerica, S.A.

Buscando registros de sa√∫de para Fogel de Centroamerica, S.A....

============================================================
Exportando registros de sa√∫de dos dispositivos...
============================================================
Per√≠odo: 12/09/2025 at√© 12/12/2025
Enviando requisi√ß√£o para: https://portal.visioniot.net/Controllers/SmartDeviceHealthRecord.ashx?v=Fri%20Dec%2012%202025%2000%3A00%3A00%20GMT%20%28Brasilia%20Standard%20Time%29
Tamanho do payload: 9754 caracteres

Status: 200
OK - Requisicao bem-sucedida!

OK - Arquivo XLSX salvo: docs/health_events.xlsx
Tamanho: 9131 bytes
OK - Arquivo verificado e salvo com sucesso!
OK - Arquivo de sa√∫de salvo: docs/Fogel_de_Centroamerica,_S.A._health_events.xlsx

Buscando registros de movimento para Fogel de Centroamerica, S.A....

============================================================
Exportando registros de movimento dos dispositivos...
============================================================
Periodo: 12/09/2025 ate 12/12/2025
Enviando requisi√ß√£o para: https://portal.visioniot.net/Controllers/SmartDeviceMovement.ashx?v=Fri%20Dec%2012%202025%2000%3A00%3A00%20GMT%20%28Brasilia%20Standard%20Time%29
Tamanho do payload: 6447 caracteres

Status: 200
OK - Requisicao bem-sucedida!

OK - Arquivo XLSX salvo: docs/movements.xlsx
Tamanho: 6501 bytes
OK - Arquivo verificado e salvo com sucesso!
OK - Arquivo de movimento salvo: docs/Fogel_de_Centroamerica,_S.A._movements.xlsx

Buscando alerts para Fogel de Centroamerica, S.A....

============================================================
Exportando dados de Alerts...
============================================================
Per√≠odo: 12/09/2025 at√© 12/12/2025
Enviando requisi√ß√£o para: https://portal.visioniot.net/Controllers/Alert.ashx?v=Fri%20Dec%2012%202025%2000%3A00%3A00%20GMT%20%28Brasilia%20Standard%20Time%29
Tamanho do payload: 6561 caracteres

Status: 200
OK - Requisi√ß√£o bem-sucedida!

OK - Arquivo CSV salvo: docs/door_statuses.csv
Tamanho: 2437332 bytes
OK - Arquivo verificado e salvo com sucesso!
OK - Arquivo de door statuses salvo: docs/Sorocaba_Refrescos_door_statuses.csv

Buscando users para Sorocaba Refrescos...

============================================================
Exportando dados de Users...
============================================================
Enviando requisi√ß√£o para: https://portal.visioniot.net/Controllers/SecurityAppUser.ashx?v=Thu%20Dec%2011%202025%2000%3A18%3A53%20GMT%20%28Brasilia%20Standard%20Time%29
Tamanho do payload: 4663 caracteres

Status: 200
OK - Requisi√ß√£o bem-sucedida!

OK - Arquivo XLSX salvo: docs/users.xlsx
Tamanho: 40969 bytes
OK - Arquivo verificado e salvo com sucesso!
OK - Arquivo de users salvo: docs/Sorocaba_Refrescos_users.xlsx

Fazendo logout de Sorocaba Refrescos...

============================================================
Fazendo logout...
============================================================
Status: 200
OK - Logout realizado com sucesso!
OK - Cookies limpos da sessao

============================================================
DOWNLOAD DI√ÅRIO COMPLETO - Sorocaba Refrescos
============================================================
Health Events: docs/Sorocaba_Refrescos_health_events.xlsx
Movements: docs/Sorocaba_Refrescos_movements.xlsx
Alerts: docs/Sorocaba_Refrescos_alerts.xlsx
Door Statuses: docs/Sorocaba_Refrescos_door_statuses.csv
Users: docs/Sorocaba_Refrescos_users.xlsx

Todos os dados di√°rios de Sorocaba Refrescos foram baixados com sucesso!
Para inserir no banco de dados, execute: python3 import_all_data.py

>>> CONCLUS√ÉO: Sorocaba Refrescos finalizado com SUCESSO

Status: 200
OK - Requisi√ß√£o bem-sucedida!

OK - Arquivo XLSX salvo: docs/alerts.xlsx
Tamanho: 6596 bytes
OK - Arquivo verificado e salvo com sucesso!
OK - Arquivo de alerts salvo: docs/Fogel_de_Centroamerica,_S.A._alerts.xlsx

Buscando door statuses para Fogel de Centroamerica, S.A....

============================================================
Exportando dados de Door Statuses...
============================================================
Per√≠odo: 12/09/2025 at√© 12/12/2025
Enviando requisi√ß√£o para: https://portal.visioniot.net/Controllers/SmartDeviceDoorStatus.ashx?v=Fri%20Dec%2012%202025%2000%3A00%3A00%20GMT%20%28Brasilia%20Standard%20Time%29
Tamanho do payload: 6933 caracteres

Status: 200
OK - Requisi√ß√£o bem-sucedida!

OK - Arquivo CSV salvo: docs/door_statuses.csv
Tamanho: 1314 bytes
OK - Arquivo verificado e salvo com sucesso!
OK - Arquivo de door statuses salvo: docs/Fogel_de_Centroamerica,_S.A._door_statuses.csv

Buscando users para Fogel de Centroamerica, S.A....

============================================================
Exportando dados de Users...
============================================================
Enviando requisi√ß√£o para: https://portal.visioniot.net/Controllers/SecurityAppUser.ashx?v=Thu%20Dec%2011%202025%2000%3A18%3A56%20GMT%20%28Brasilia%20Standard%20Time%29
Tamanho do payload: 4663 caracteres

Status: 200
OK - Requisi√ß√£o bem-sucedida!

OK - Arquivo XLSX salvo: docs/users.xlsx
Tamanho: 6868 bytes
OK - Arquivo verificado e salvo com sucesso!
OK - Arquivo de users salvo: docs/Fogel_de_Centroamerica,_S.A._users.xlsx

Fazendo logout de Fogel de Centroamerica, S.A....

============================================================
Fazendo logout...
============================================================
Status: 200
OK - Logout realizado com sucesso!
OK - Cookies limpos da sessao

============================================================
DOWNLOAD DI√ÅRIO COMPLETO - Fogel de Centroamerica, S.A.
============================================================
Health Events: docs/Fogel_de_Centroamerica,_S.A._health_events.xlsx
Movements: docs/Fogel_de_Centroamerica,_S.A._movements.xlsx
Alerts: docs/Fogel_de_Centroamerica,_S.A._alerts.xlsx
Door Statuses: docs/Fogel_de_Centroamerica,_S.A._door_statuses.csv
Users: docs/Fogel_de_Centroamerica,_S.A._users.xlsx

Todos os dados di√°rios de Fogel de Centroamerica, S.A. foram baixados com sucesso!
Para inserir no banco de dados, execute: python3 import_all_data.py

>>> CONCLUS√ÉO: Fogel de Centroamerica, S.A. finalizado com SUCESSO

================================================================================
RESUMO FINAL - TODOS OS CLIENTES (DAILY)
================================================================================
Redbull: ‚úì SUCESSO
ABI Brasil: ‚úì SUCESSO
Sorocaba Refrescos: ‚úì SUCESSO
Fogel de Centroamerica, S.A.: ‚úì SUCESSO

Total processado: 4/4 clientes com sucesso
‚úì Todos os clientes processados com sucesso!

============================================================
INICIANDO IMPORTA√á√ÉO AUTOM√ÅTICA DOS DADOS
============================================================
Reiniciando servi√ßo PostgreSQL...
‚úì PostgreSQL reiniciado com sucesso.
‚úì Importa√ß√£o autom√°tica conclu√≠da com sucesso!

Sa√≠da da importa√ß√£o:

================================================================================
üöÄ IMPORTA√á√ÉO EM LOTE OTIMIZADA (MULTIPROCESSING) - PORTAL ASSOCIA√á√ÉO
================================================================================

üìÇ Encontrados 20 arquivo(s) para importa√ß√£o.
‚öôÔ∏è  Utilizando 4 processos paralelos.

üöÄ [PID 1000517] Iniciando ABI_Brasil_alerts.xlsx (Alert)...
üöÄ Iniciando importa√ß√£o para Alert...
‚öôÔ∏è Processando 1 registros...
‚úÖ Processados 1 registros v√°lidos para inser√ß√£o
   ‚Ü≥ Lote 1: 1 registros processados.
‚úÖ Alert importado. Total processado (Insert/Update): 1
üîÑ Atualizando Materialized Views...
üöÄ [PID 1000517] Iniciando ABI_Brasil_users.xlsx (User)...
üöÄ Iniciando importa√ß√£o para User...
‚öôÔ∏è Processando 4690 registros...
‚úÖ Processados 4690 registros v√°lidos para inser√ß√£o
   ‚Ü≥ Lote 1: 4690 registros processados.
‚úÖ User importado. Total processado (Insert/Update): 4690
üöÄ [PID 1000517] Iniciando Fogel_de_Centroamerica,_S.A._alerts.xlsx (Alert)...
üöÄ Iniciando importa√ß√£o para Alert...
‚öôÔ∏è Processando 0 registros...
‚úÖ Processados 0 registros v√°lidos para inser√ß√£o
‚ö†Ô∏è Nenhum registro v√°lido para importar.
üöÄ [PID 1000517] Iniciando Fogel_de_Centroamerica,_S.A._door_statuses.csv (DoorEvent)...
üöÄ Iniciando importa√ß√£o para DoorEvent...
‚öôÔ∏è Processando 0 registros...
‚úÖ Processados 0 registros v√°lidos para inser√ß√£o
‚ö†Ô∏è Nenhum registro v√°lido para importar.
üöÄ [PID 1000517] Iniciando Fogel_de_Centroamerica,_S.A._health_events.xlsx (HealthEvent)...
üöÄ Iniciando importa√ß√£o para HealthEvent...
‚öôÔ∏è Processando 11 registros...
‚úÖ Processados 11 registros v√°lidos para inser√ß√£o
   ‚Ü≥ Lote 1: 11 registros processados.
‚úÖ HealthEvent importado. Total processado (Insert/Update): 11
üîÑ Atualizando Materialized Views...
üöÄ [PID 1000517] Iniciando Sorocaba_Refrescos_users.xlsx (User)...
üöÄ Iniciando importa√ß√£o para User...
‚öôÔ∏è Processando 264 registros...
‚úÖ Processados 264 registros v√°lidos para inser√ß√£o
   ‚Ü≥ Lote 1: 264 registros processados.
‚úÖ User importado. Total processado (Insert/Update): 264
üöÄ [PID 1000520] Iniciando ABI_Brasil_movements.xlsx (Movement)...
üöÄ Iniciando importa√ß√£o para Movement...
‚öôÔ∏è Processando 1762 registros...
‚úÖ Processados 1762 registros v√°lidos para inser√ß√£o
   ‚Ü≥ Lote 1: 1762 registros processados.
‚úÖ Movement importado. Total processado (Insert/Update): 1762
üîÑ Atualizando Materialized Views...
üöÄ [PID 1000520] Iniciando Sorocaba_Refrescos_door_statuses.csv (DoorEvent)...
üöÄ Iniciando importa√ß√£o para DoorEvent...
‚öôÔ∏è Processando 2451 registros...
‚úÖ Processados 2451 registros v√°lidos para inser√ß√£o
   ‚Ü≥ Lote 1: 2451 registros processados.
‚úÖ DoorEvent importado. Total processado (Insert/Update): 2451
üîÑ Atualizando Materialized Views...
üöÄ [PID 1000518] Iniciando ABI_Brasil_door_statuses.csv (DoorEvent)...
üöÄ Iniciando importa√ß√£o para DoorEvent...
‚öôÔ∏è Processando 507 registros...
‚úÖ Processados 507 registros v√°lidos para inser√ß√£o
   ‚Ü≥ Lote 1: 507 registros processados.
‚úÖ DoorEvent importado. Total processado (Insert/Update): 507
üîÑ Atualizando Materialized Views...
üöÄ [PID 1000518] Iniciando Sorocaba_Refrescos_health_events.xlsx (HealthEvent)...
üöÄ Iniciando importa√ß√£o para HealthEvent...
‚öôÔ∏è Processando 4541 registros...
‚úÖ Processados 4541 registros v√°lidos para inser√ß√£o
   ‚Ü≥ Lote 1: 4541 registros processados.
‚úÖ HealthEvent importado. Total processado (Insert/Update): 4541
üîÑ Atualizando Materialized Views...
üöÄ [PID 1000519] Iniciando ABI_Brasil_health_events.xlsx (HealthEvent)...
üöÄ Iniciando importa√ß√£o para HealthEvent...
‚öôÔ∏è Processando 515 registros...
‚úÖ Processados 515 registros v√°lidos para inser√ß√£o
   ‚Ü≥ Lote 1: 515 registros processados.
‚úÖ HealthEvent importado. Total processado (Insert/Update): 515
üîÑ Atualizando Materialized Views...
üöÄ [PID 1000519] Iniciando Fogel_de_Centroamerica,_S.A._movements.xlsx (Movement)...
üöÄ Iniciando importa√ß√£o para Movement...
‚öôÔ∏è Processando 0 registros...
‚úÖ Processados 0 registros v√°lidos para inser√ß√£o
‚ö†Ô∏è Nenhum registro v√°lido para importar.
üöÄ [PID 1000519] Iniciando Fogel_de_Centroamerica,_S.A._users.xlsx (User)...
üöÄ Iniciando importa√ß√£o para User...
‚öôÔ∏è Processando 3 registros...
‚úÖ Processados 3 registros v√°lidos para inser√ß√£o
   ‚Ü≥ Lote 1: 3 registros processados.
‚úÖ User importado. Total processado (Insert/Update): 3
üöÄ [PID 1000519] Iniciando Redbull_alerts.xlsx (Alert)...
üöÄ Iniciando importa√ß√£o para Alert...
‚ùå Erro na importa√ß√£o de Alert: Excel file format cannot be determined, you must specify an engine manually.
üöÄ [PID 1000519] Iniciando Redbull_door_statuses.csv (DoorEvent)...
üöÄ Iniciando importa√ß√£o para DoorEvent...
‚ö†Ô∏è Nenhuma coluna correspondente encontrada no arquivo docs/Redbull_door_statuses.csv
   Colunas encontradas: ['{"errors":null', 'info:"Session has expired!"', 'data:null', 'combos:{}', 'moreInfo:null']...
üöÄ [PID 1000519] Iniciando Redbull_health_events.xlsx (HealthEvent)...
üöÄ Iniciando importa√ß√£o para HealthEvent...
‚ùå Erro na importa√ß√£o de HealthEvent: Excel file format cannot be determined, you must specify an engine manually.
üöÄ [PID 1000519] Iniciando Redbull_movements.xlsx (Movement)...
üöÄ Iniciando importa√ß√£o para Movement...
‚ùå Erro na importa√ß√£o de Movement: Excel file format cannot be determined, you must specify an engine manually.
üöÄ [PID 1000519] Iniciando Redbull_users.xlsx (User)...
üöÄ Iniciando importa√ß√£o para User...
‚ùå Erro na importa√ß√£o de User: Excel file format cannot be determined, you must specify an engine manually.
üöÄ [PID 1000519] Iniciando Sorocaba_Refrescos_alerts.xlsx (Alert)...
üöÄ Iniciando importa√ß√£o para Alert...
‚öôÔ∏è Processando 14 registros...
‚úÖ Processados 14 registros v√°lidos para inser√ß√£o
   ‚Ü≥ Lote 1: 14 registros processados.
‚úÖ Alert importado. Total processado (Insert/Update): 14
üîÑ Atualizando Materialized Views...
üöÄ [PID 1000519] Iniciando Sorocaba_Refrescos_movements.xlsx (Movement)...
üöÄ Iniciando importa√ß√£o para Movement...
‚öôÔ∏è Processando 5258 registros...
‚úÖ Processados 5258 registros v√°lidos para inser√ß√£o
   ‚Ü≥ Lote 1: 5000 registros processados.
   ‚Ü≥ Lote 2: 258 registros processados.
‚úÖ Movement importado. Total processado (Insert/Update): 5258
üîÑ Atualizando Materialized Views...
‚úÖ ABI_Brasil_alerts.xlsx: Sucesso. (Arquivo deletado)
‚úÖ ABI_Brasil_users.xlsx: Sucesso. (Arquivo deletado)
‚úÖ Fogel_de_Centroamerica,_S.A._alerts.xlsx: Sucesso. (Arquivo deletado)
‚úÖ Fogel_de_Centroamerica,_S.A._door_statuses.csv: Sucesso. (Arquivo deletado)
‚úÖ ABI_Brasil_health_events.xlsx: Sucesso. (Arquivo deletado)
‚úÖ Fogel_de_Centroamerica,_S.A._movements.xlsx: Sucesso. (Arquivo deletado)
‚úÖ Fogel_de_Centroamerica,_S.A._users.xlsx: Sucesso. (Arquivo deletado)
‚ùå Redbull_alerts.xlsx: Falha. Falha na importa√ß√£o gen√©rica
‚ùå Redbull_door_statuses.csv: Falha. Falha na importa√ß√£o gen√©rica
‚ùå Redbull_health_events.xlsx: Falha. Falha na importa√ß√£o gen√©rica
‚ùå Redbull_movements.xlsx: Falha. Falha na importa√ß√£o gen√©rica
‚ùå Redbull_users.xlsx: Falha. Falha na importa√ß√£o gen√©rica
‚úÖ ABI_Brasil_movements.xlsx: Sucesso. (Arquivo deletado)
‚úÖ ABI_Brasil_door_statuses.csv: Sucesso. (Arquivo deletado)
‚úÖ Sorocaba_Refrescos_alerts.xlsx: Sucesso. (Arquivo deletado)
‚úÖ Fogel_de_Centroamerica,_S.A._health_events.xlsx: Sucesso. (Arquivo deletado)
‚úÖ Sorocaba_Refrescos_users.xlsx: Sucesso. (Arquivo deletado)
‚úÖ Sorocaba_Refrescos_door_statuses.csv: Sucesso. (Arquivo deletado)
‚úÖ Sorocaba_Refrescos_health_events.xlsx: Sucesso. (Arquivo deletado)
‚úÖ Sorocaba_Refrescos_movements.xlsx: Sucesso. (Arquivo deletado)

‚è±Ô∏è  Tempo total: 275.93 segundos
üìä Resumo: 15/20 arquivos importados com sucesso

üîÑ Atualizando Materialized Views finais...
‚úÖ Materialized Views atualizadas.

[2025-12-11 00:23:42] ‚úì Scraping conclu√≠do com sucesso
[2025-12-11 00:23:42] ============================================
[2025-12-11 00:23:42] Iniciando importa√ß√£o em lote
[2025-12-11 00:23:42] ============================================
[2025-12-11 00:23:42] Arquivos encontrados em docs/, executando importa√ß√£o...
[2025-12-11 00:23:42] Executando: python3 /home/vivaservicesai/htdocs/app/import_all_data.py

================================================================================
üöÄ IMPORTA√á√ÉO EM LOTE OTIMIZADA (MULTIPROCESSING) - PORTAL ASSOCIA√á√ÉO
================================================================================

üìÇ Encontrados 5 arquivo(s) para importa√ß√£o.
‚öôÔ∏è  Utilizando 4 processos paralelos.

üöÄ [PID 1000956] Iniciando Redbull_alerts.xlsx (Alert)...
üöÄ Iniciando importa√ß√£o para Alert...
‚ùå Erro na importa√ß√£o de Alert: Excel file format cannot be determined, you must specify an engine manually.
üöÄ [PID 1000956] Iniciando Redbull_users.xlsx (User)...
üöÄ Iniciando importa√ß√£o para User...
‚ùå Erro na importa√ß√£o de User: Excel file format cannot be determined, you must specify an engine manually.
üöÄ [PID 1000958] Iniciando Redbull_health_events.xlsx (HealthEvent)...
üöÄ Iniciando importa√ß√£o para HealthEvent...
‚ùå Erro na importa√ß√£o de HealthEvent: Excel file format cannot be determined, you must specify an engine manually.
üöÄ [PID 1000959] Iniciando Redbull_movements.xlsx (Movement)...
üöÄ Iniciando importa√ß√£o para Movement...
‚ùå Erro na importa√ß√£o de Movement: Excel file format cannot be determined, you must specify an engine manually.
üöÄ [PID 1000957] Iniciando Redbull_door_statuses.csv (DoorEvent)...
üöÄ Iniciando importa√ß√£o para DoorEvent...
‚ö†Ô∏è Nenhuma coluna correspondente encontrada no arquivo docs/Redbull_door_statuses.csv
   Colunas encontradas: ['{"errors":null', 'info:"Session has expired!"', 'data:null', 'combos:{}', 'moreInfo:null']...
‚ùå Redbull_alerts.xlsx: Falha. Falha na importa√ß√£o gen√©rica
‚ùå Redbull_users.xlsx: Falha. Falha na importa√ß√£o gen√©rica
‚ùå Redbull_health_events.xlsx: Falha. Falha na importa√ß√£o gen√©rica
‚ùå Redbull_movements.xlsx: Falha. Falha na importa√ß√£o gen√©rica
‚ùå Redbull_door_statuses.csv: Falha. Falha na importa√ß√£o gen√©rica

‚è±Ô∏è  Tempo total: 0.05 segundos
üìä Resumo: 0/5 arquivos importados com sucesso
[2025-12-11 00:23:43] ‚úì Importa√ß√£o conclu√≠da com sucesso
[2025-12-11 00:23:43] ============================================
[2025-12-11 00:23:43] Scraping e importa√ß√£o di√°rios finalizados
[2025-12-11 00:23:43] ============================================
[2025-12-11 10:00:01] ============================================
[2025-12-11 10:00:01] Iniciando scraping paralelo di√°rio
[2025-12-11 10:00:01] ============================================
[2025-12-11 10:00:01] Venv ativado com sucesso
[2025-12-11 10:00:01] Navegado para /home/vivaservicesai/htdocs/app
[2025-12-11 10:00:01] Executando: python3 utils/scraping_parallel.py daily 2
INICIANDO SCRAPING PARALELO (DAILY) - Max Workers: 2
================================================================================
Encontradas 4 contas para processar:
  - Redbull (Username: redbull_34326546457657658658568658657567657567567567567)
  - ABI Brasil (Username: abib_493)
  - Sorocaba Refrescos (Username: sorocaba_215)
  - Fogel de Centroamerica, S.A. (Username: fgl_426)

Iniciando processamento paralelo...

================================================================================
PROCESSANDO CLIENTE (DADOS DI√ÅRIOS): Redbull (Username: redbull_34326546457657658658568658657567657567567567567)
================================================================================
Passo 1: Fazendo GET inicial para estabelecer sessao para redbull_34326546457657658658568658657567657567567567567...

================================================================================
PROCESSANDO CLIENTE (DADOS DI√ÅRIOS): ABI Brasil (Username: abib_493)
================================================================================
Passo 1: Fazendo GET inicial para estabelecer sessao para abib_493...
GET Status: 200

Passo 2: Fazendo POST com credenciais...
GET Status: 200

Passo 2: Fazendo POST com credenciais...
Login Status: 302
OK - Login bem-sucedido! Seguindo redirect...
Login Status: 401
Sessao existente detectada. Terminando sessao anterior...
Terminate Session Status: 200
OK - Sessao anterior terminada!
Cookies apos terminar sessao:
  ASP.NET_SessionId

Fazendo login apos terminar sessao existente...
Default Page Status: 200
Login realizado com sucesso para ABI Brasil

Buscando registros de sa√∫de para ABI Brasil...

============================================================
Exportando registros de sa√∫de dos dispositivos...
============================================================
Per√≠odo: 12/09/2025 at√© 12/12/2025
Enviando requisi√ß√£o para: https://portal.visioniot.net/Controllers/SmartDeviceHealthRecord.ashx?v=Fri%20Dec%2012%202025%2000%3A00%3A00%20GMT%20%28Brasilia%20Standard%20Time%29
Tamanho do payload: 9754 caracteres
Login Status (2a tentativa): 401
ERRO - Falha no login apos terminar sessao
Default Page Status: 200
Login realizado com sucesso para Redbull

Buscando registros de sa√∫de para Redbull...

============================================================
Exportando registros de sa√∫de dos dispositivos...
============================================================
Per√≠odo: 12/09/2025 at√© 12/12/2025
Enviando requisi√ß√£o para: https://portal.visioniot.net/Controllers/SmartDeviceHealthRecord.ashx?v=Fri%20Dec%2012%202025%2000%3A00%3A00%20GMT%20%28Brasilia%20Standard%20Time%29
Tamanho do payload: 9754 caracteres

Status: 200
OK - Requisicao bem-sucedida!

OK - Arquivo XLSX salvo: docs/health_events.xlsx
Tamanho: 101 bytes
OK - Arquivo verificado e salvo com sucesso!
OK - Arquivo de sa√∫de salvo: docs/Redbull_health_events.xlsx

Buscando registros de movimento para Redbull...

============================================================
Exportando registros de movimento dos dispositivos...
============================================================
Periodo: 12/09/2025 ate 12/12/2025
Enviando requisi√ß√£o para: https://portal.visioniot.net/Controllers/SmartDeviceMovement.ashx?v=Fri%20Dec%2012%202025%2000%3A00%3A00%20GMT%20%28Brasilia%20Standard%20Time%29
Tamanho do payload: 6447 caracteres

Status: 200
OK - Requisicao bem-sucedida!

OK - Arquivo XLSX salvo: docs/movements.xlsx
Tamanho: 101 bytes
OK - Arquivo verificado e salvo com sucesso!
OK - Arquivo de movimento salvo: docs/Redbull_movements.xlsx

Buscando alerts para Redbull...

============================================================
Exportando dados de Alerts...
============================================================
Per√≠odo: 12/09/2025 at√© 12/12/2025
Enviando requisi√ß√£o para: https://portal.visioniot.net/Controllers/Alert.ashx?v=Fri%20Dec%2012%202025%2000%3A00%3A00%20GMT%20%28Brasilia%20Standard%20Time%29
Tamanho do payload: 6561 caracteres

Status: 200
OK - Requisi√ß√£o bem-sucedida!

OK - Arquivo XLSX salvo: docs/alerts.xlsx
Tamanho: 101 bytes
OK - Arquivo verificado e salvo com sucesso!
OK - Arquivo de alerts salvo: docs/Redbull_alerts.xlsx

Buscando door statuses para Redbull...

============================================================
Exportando dados de Door Statuses...
============================================================
Per√≠odo: 12/09/2025 at√© 12/12/2025
Enviando requisi√ß√£o para: https://portal.visioniot.net/Controllers/SmartDeviceDoorStatus.ashx?v=Fri%20Dec%2012%202025%2000%3A00%3A00%20GMT%20%28Brasilia%20Standard%20Time%29
Tamanho do payload: 6933 caracteres

Status: 200
OK - Requisi√ß√£o bem-sucedida!

OK - Arquivo CSV salvo: docs/door_statuses.csv
Tamanho: 101 bytes
OK - Arquivo verificado e salvo com sucesso!
OK - Arquivo de door statuses salvo: docs/Redbull_door_statuses.csv

Buscando users para Redbull...

============================================================
Exportando dados de Users...
============================================================
Enviando requisi√ß√£o para: https://portal.visioniot.net/Controllers/SecurityAppUser.ashx?v=Thu%20Dec%2011%202025%2010%3A00%3A10%20GMT%20%28Brasilia%20Standard%20Time%29
Tamanho do payload: 4663 caracteres

Status: 200
OK - Requisi√ß√£o bem-sucedida!

OK - Arquivo XLSX salvo: docs/users.xlsx
Tamanho: 101 bytes
OK - Arquivo verificado e salvo com sucesso!
OK - Arquivo de users salvo: docs/Redbull_users.xlsx

Fazendo logout de Redbull...

============================================================
Fazendo logout...
============================================================
Nenhuma sessao ativa detectada (sem cookie .ASPXAUTH)
Limpando cookies locais...
OK - Cookies limpos

============================================================
DOWNLOAD DI√ÅRIO COMPLETO - Redbull
============================================================
Health Events: docs/Redbull_health_events.xlsx
Movements: docs/Redbull_movements.xlsx
Alerts: docs/Redbull_alerts.xlsx
Door Statuses: docs/Redbull_door_statuses.csv
Users: docs/Redbull_users.xlsx

Todos os dados di√°rios de Redbull foram baixados com sucesso!
Para inserir no banco de dados, execute: python3 import_all_data.py

================================================================================
PROCESSANDO CLIENTE (DADOS DI√ÅRIOS): Sorocaba Refrescos (Username: sorocaba_215)
================================================================================
Passo 1: Fazendo GET inicial para estabelecer sessao para sorocaba_215...

>>> CONCLUS√ÉO: Redbull finalizado com SUCESSO
GET Status: 200

Passo 2: Fazendo POST com credenciais...
Login Status: 302
OK - Login bem-sucedido! Seguindo redirect...
Default Page Status: 200
Login realizado com sucesso para Sorocaba Refrescos

Buscando registros de sa√∫de para Sorocaba Refrescos...

============================================================
Exportando registros de sa√∫de dos dispositivos...
============================================================
Per√≠odo: 12/09/2025 at√© 12/12/2025
Enviando requisi√ß√£o para: https://portal.visioniot.net/Controllers/SmartDeviceHealthRecord.ashx?v=Fri%20Dec%2012%202025%2000%3A00%3A00%20GMT%20%28Brasilia%20Standard%20Time%29
Tamanho do payload: 9754 caracteres

Status: 200
OK - Requisicao bem-sucedida!

OK - Arquivo XLSX salvo: docs/health_events.xlsx
Tamanho: 111987 bytes
OK - Arquivo verificado e salvo com sucesso!
OK - Arquivo de sa√∫de salvo: docs/ABI_Brasil_health_events.xlsx

Buscando registros de movimento para ABI Brasil...

============================================================
Exportando registros de movimento dos dispositivos...
============================================================
Periodo: 12/09/2025 ate 12/12/2025
Enviando requisi√ß√£o para: https://portal.visioniot.net/Controllers/SmartDeviceMovement.ashx?v=Fri%20Dec%2012%202025%2000%3A00%3A00%20GMT%20%28Brasilia%20Standard%20Time%29
Tamanho do payload: 6447 caracteres

Status: 200
OK - Requisicao bem-sucedida!

OK - Arquivo XLSX salvo: docs/health_events.xlsx
Tamanho: 932868 bytes
OK - Arquivo verificado e salvo com sucesso!
OK - Arquivo de sa√∫de salvo: docs/Sorocaba_Refrescos_health_events.xlsx

Buscando registros de movimento para Sorocaba Refrescos...

============================================================
Exportando registros de movimento dos dispositivos...
============================================================
Periodo: 12/09/2025 ate 12/12/2025
Enviando requisi√ß√£o para: https://portal.visioniot.net/Controllers/SmartDeviceMovement.ashx?v=Fri%20Dec%2012%202025%2000%3A00%3A00%20GMT%20%28Brasilia%20Standard%20Time%29
Tamanho do payload: 6447 caracteres

Status: 200
OK - Requisicao bem-sucedida!

OK - Arquivo XLSX salvo: docs/movements.xlsx
Tamanho: 303638 bytes
OK - Arquivo verificado e salvo com sucesso!
OK - Arquivo de movimento salvo: docs/ABI_Brasil_movements.xlsx

Buscando alerts para ABI Brasil...

============================================================
Exportando dados de Alerts...
============================================================
Per√≠odo: 12/09/2025 at√© 12/12/2025
Enviando requisi√ß√£o para: https://portal.visioniot.net/Controllers/Alert.ashx?v=Fri%20Dec%2012%202025%2000%3A00%3A00%20GMT%20%28Brasilia%20Standard%20Time%29
Tamanho do payload: 6561 caracteres

Status: 200
OK - Requisicao bem-sucedida!

OK - Arquivo XLSX salvo: docs/movements.xlsx
Tamanho: 899054 bytes
OK - Arquivo verificado e salvo com sucesso!
OK - Arquivo de movimento salvo: docs/Sorocaba_Refrescos_movements.xlsx

Buscando alerts para Sorocaba Refrescos...

============================================================
Exportando dados de Alerts...
============================================================
Per√≠odo: 12/09/2025 at√© 12/12/2025
Enviando requisi√ß√£o para: https://portal.visioniot.net/Controllers/Alert.ashx?v=Fri%20Dec%2012%202025%2000%3A00%3A00%20GMT%20%28Brasilia%20Standard%20Time%29
Tamanho do payload: 6561 caracteres

Status: 200
OK - Requisi√ß√£o bem-sucedida!

OK - Arquivo XLSX salvo: docs/alerts.xlsx
Tamanho: 7088 bytes
OK - Arquivo verificado e salvo com sucesso!
OK - Arquivo de alerts salvo: docs/ABI_Brasil_alerts.xlsx

Buscando door statuses para ABI Brasil...

============================================================
Exportando dados de Door Statuses...
============================================================
Per√≠odo: 12/09/2025 at√© 12/12/2025
Enviando requisi√ß√£o para: https://portal.visioniot.net/Controllers/SmartDeviceDoorStatus.ashx?v=Fri%20Dec%2012%202025%2000%3A00%3A00%20GMT%20%28Brasilia%20Standard%20Time%29
Tamanho do payload: 6933 caracteres

Status: 200
OK - Requisi√ß√£o bem-sucedida!

OK - Arquivo XLSX salvo: docs/alerts.xlsx
Tamanho: 11297 bytes
OK - Arquivo verificado e salvo com sucesso!
OK - Arquivo de alerts salvo: docs/Sorocaba_Refrescos_alerts.xlsx

Buscando door statuses para Sorocaba Refrescos...

============================================================
Exportando dados de Door Statuses...
============================================================
Per√≠odo: 12/09/2025 at√© 12/12/2025
Enviando requisi√ß√£o para: https://portal.visioniot.net/Controllers/SmartDeviceDoorStatus.ashx?v=Fri%20Dec%2012%202025%2000%3A00%3A00%20GMT%20%28Brasilia%20Standard%20Time%29
Tamanho do payload: 6933 caracteres

Status: 200
OK - Requisi√ß√£o bem-sucedida!

OK - Arquivo CSV salvo: docs/door_statuses.csv
Tamanho: 462248 bytes
OK - Arquivo verificado e salvo com sucesso!
OK - Arquivo de door statuses salvo: docs/ABI_Brasil_door_statuses.csv

Buscando users para ABI Brasil...

============================================================
Exportando dados de Users...
============================================================
Enviando requisi√ß√£o para: https://portal.visioniot.net/Controllers/SecurityAppUser.ashx?v=Thu%20Dec%2011%202025%2010%3A01%3A01%20GMT%20%28Brasilia%20Standard%20Time%29
Tamanho do payload: 4663 caracteres

Status: 200
OK - Requisi√ß√£o bem-sucedida!

OK - Arquivo CSV salvo: docs/door_statuses.csv
Tamanho: 2437332 bytes
OK - Arquivo verificado e salvo com sucesso!
OK - Arquivo de door statuses salvo: docs/Sorocaba_Refrescos_door_statuses.csv

Buscando users para Sorocaba Refrescos...

============================================================
Exportando dados de Users...
============================================================
Enviando requisi√ß√£o para: https://portal.visioniot.net/Controllers/SecurityAppUser.ashx?v=Thu%20Dec%2011%202025%2010%3A01%3A17%20GMT%20%28Brasilia%20Standard%20Time%29
Tamanho do payload: 4663 caracteres

Status: 200
OK - Requisi√ß√£o bem-sucedida!

OK - Arquivo XLSX salvo: docs/users.xlsx
Tamanho: 40964 bytes
OK - Arquivo verificado e salvo com sucesso!
OK - Arquivo de users salvo: docs/Sorocaba_Refrescos_users.xlsx

Fazendo logout de Sorocaba Refrescos...

============================================================
Fazendo logout...
============================================================
Status: 200
OK - Logout realizado com sucesso!
OK - Cookies limpos da sessao

============================================================
DOWNLOAD DI√ÅRIO COMPLETO - Sorocaba Refrescos
============================================================
Health Events: docs/Sorocaba_Refrescos_health_events.xlsx
Movements: docs/Sorocaba_Refrescos_movements.xlsx
Alerts: docs/Sorocaba_Refrescos_alerts.xlsx
Door Statuses: docs/Sorocaba_Refrescos_door_statuses.csv
Users: docs/Sorocaba_Refrescos_users.xlsx

Todos os dados di√°rios de Sorocaba Refrescos foram baixados com sucesso!
Para inserir no banco de dados, execute: python3 import_all_data.py

================================================================================
PROCESSANDO CLIENTE (DADOS DI√ÅRIOS): Fogel de Centroamerica, S.A. (Username: fgl_426)
================================================================================
Passo 1: Fazendo GET inicial para estabelecer sessao para fgl_426...

>>> CONCLUS√ÉO: Sorocaba Refrescos finalizado com SUCESSO

Status: 200
OK - Requisi√ß√£o bem-sucedida!

OK - Arquivo XLSX salvo: docs/users.xlsx
Tamanho: 536381 bytes
OK - Arquivo verificado e salvo com sucesso!
OK - Arquivo de users salvo: docs/ABI_Brasil_users.xlsx

Fazendo logout de ABI Brasil...

============================================================
Fazendo logout...
============================================================
Status: 200
OK - Logout realizado com sucesso!
OK - Cookies limpos da sessao

============================================================
DOWNLOAD DI√ÅRIO COMPLETO - ABI Brasil
============================================================
Health Events: docs/ABI_Brasil_health_events.xlsx
Movements: docs/ABI_Brasil_movements.xlsx
Alerts: docs/ABI_Brasil_alerts.xlsx
Door Statuses: docs/ABI_Brasil_door_statuses.csv
Users: docs/ABI_Brasil_users.xlsx

Todos os dados di√°rios de ABI Brasil foram baixados com sucesso!
Para inserir no banco de dados, execute: python3 import_all_data.py

>>> CONCLUS√ÉO: ABI Brasil finalizado com SUCESSO
GET Status: 200

Passo 2: Fazendo POST com credenciais...
Login Status: 302
OK - Login bem-sucedido! Seguindo redirect...
Default Page Status: 200
Login realizado com sucesso para Fogel de Centroamerica, S.A.

Buscando registros de sa√∫de para Fogel de Centroamerica, S.A....

============================================================
Exportando registros de sa√∫de dos dispositivos...
============================================================
Per√≠odo: 12/09/2025 at√© 12/12/2025
Enviando requisi√ß√£o para: https://portal.visioniot.net/Controllers/SmartDeviceHealthRecord.ashx?v=Fri%20Dec%2012%202025%2000%3A00%3A00%20GMT%20%28Brasilia%20Standard%20Time%29
Tamanho do payload: 9754 caracteres

Status: 200
OK - Requisicao bem-sucedida!

OK - Arquivo XLSX salvo: docs/health_events.xlsx
Tamanho: 9130 bytes
OK - Arquivo verificado e salvo com sucesso!
OK - Arquivo de sa√∫de salvo: docs/Fogel_de_Centroamerica,_S.A._health_events.xlsx

Buscando registros de movimento para Fogel de Centroamerica, S.A....

============================================================
Exportando registros de movimento dos dispositivos...
============================================================
Periodo: 12/09/2025 ate 12/12/2025
Enviando requisi√ß√£o para: https://portal.visioniot.net/Controllers/SmartDeviceMovement.ashx?v=Fri%20Dec%2012%202025%2000%3A00%3A00%20GMT%20%28Brasilia%20Standard%20Time%29
Tamanho do payload: 6447 caracteres

Status: 200
OK - Requisicao bem-sucedida!

OK - Arquivo XLSX salvo: docs/movements.xlsx
Tamanho: 6499 bytes
OK - Arquivo verificado e salvo com sucesso!
OK - Arquivo de movimento salvo: docs/Fogel_de_Centroamerica,_S.A._movements.xlsx

Buscando alerts para Fogel de Centroamerica, S.A....

============================================================
Exportando dados de Alerts...
============================================================
Per√≠odo: 12/09/2025 at√© 12/12/2025
Enviando requisi√ß√£o para: https://portal.visioniot.net/Controllers/Alert.ashx?v=Fri%20Dec%2012%202025%2000%3A00%3A00%20GMT%20%28Brasilia%20Standard%20Time%29
Tamanho do payload: 6561 caracteres

Status: 200
OK - Requisi√ß√£o bem-sucedida!

OK - Arquivo XLSX salvo: docs/alerts.xlsx
Tamanho: 6594 bytes
OK - Arquivo verificado e salvo com sucesso!
OK - Arquivo de alerts salvo: docs/Fogel_de_Centroamerica,_S.A._alerts.xlsx

Buscando door statuses para Fogel de Centroamerica, S.A....

============================================================
Exportando dados de Door Statuses...
============================================================
Per√≠odo: 12/09/2025 at√© 12/12/2025
Enviando requisi√ß√£o para: https://portal.visioniot.net/Controllers/SmartDeviceDoorStatus.ashx?v=Fri%20Dec%2012%202025%2000%3A00%3A00%20GMT%20%28Brasilia%20Standard%20Time%29
Tamanho do payload: 6933 caracteres

Status: 200
OK - Requisi√ß√£o bem-sucedida!

OK - Arquivo CSV salvo: docs/door_statuses.csv
Tamanho: 1314 bytes
OK - Arquivo verificado e salvo com sucesso!
OK - Arquivo de door statuses salvo: docs/Fogel_de_Centroamerica,_S.A._door_statuses.csv

Buscando users para Fogel de Centroamerica, S.A....

============================================================
Exportando dados de Users...
============================================================
Enviando requisi√ß√£o para: https://portal.visioniot.net/Controllers/SecurityAppUser.ashx?v=Thu%20Dec%2011%202025%2010%3A01%3A43%20GMT%20%28Brasilia%20Standard%20Time%29
Tamanho do payload: 4663 caracteres

Status: 200
OK - Requisi√ß√£o bem-sucedida!

OK - Arquivo XLSX salvo: docs/users.xlsx
Tamanho: 6863 bytes
OK - Arquivo verificado e salvo com sucesso!
OK - Arquivo de users salvo: docs/Fogel_de_Centroamerica,_S.A._users.xlsx

Fazendo logout de Fogel de Centroamerica, S.A....

============================================================
Fazendo logout...
============================================================
Status: 200
OK - Logout realizado com sucesso!
OK - Cookies limpos da sessao

============================================================
DOWNLOAD DI√ÅRIO COMPLETO - Fogel de Centroamerica, S.A.
============================================================
Health Events: docs/Fogel_de_Centroamerica,_S.A._health_events.xlsx
Movements: docs/Fogel_de_Centroamerica,_S.A._movements.xlsx
Alerts: docs/Fogel_de_Centroamerica,_S.A._alerts.xlsx
Door Statuses: docs/Fogel_de_Centroamerica,_S.A._door_statuses.csv
Users: docs/Fogel_de_Centroamerica,_S.A._users.xlsx

Todos os dados di√°rios de Fogel de Centroamerica, S.A. foram baixados com sucesso!
Para inserir no banco de dados, execute: python3 import_all_data.py

>>> CONCLUS√ÉO: Fogel de Centroamerica, S.A. finalizado com SUCESSO

================================================================================
RESUMO FINAL - TODOS OS CLIENTES (DAILY)
================================================================================
Redbull: ‚úì SUCESSO
Sorocaba Refrescos: ‚úì SUCESSO
ABI Brasil: ‚úì SUCESSO
Fogel de Centroamerica, S.A.: ‚úì SUCESSO

Total processado: 4/4 clientes com sucesso
‚úì Todos os clientes processados com sucesso!

============================================================
INICIANDO IMPORTA√á√ÉO AUTOM√ÅTICA DOS DADOS
============================================================
Reiniciando servi√ßo PostgreSQL...
‚úì PostgreSQL reiniciado com sucesso.
‚úì Importa√ß√£o autom√°tica conclu√≠da com sucesso!

Sa√≠da da importa√ß√£o:

================================================================================
üöÄ IMPORTA√á√ÉO EM LOTE OTIMIZADA (MULTIPROCESSING) - PORTAL ASSOCIA√á√ÉO
================================================================================

üìÇ Encontrados 20 arquivo(s) para importa√ß√£o.
‚öôÔ∏è  Utilizando 4 processos paralelos.

üöÄ [PID 1022647] Iniciando ABI_Brasil_movements.xlsx (Movement)...
üöÄ Iniciando importa√ß√£o para Movement...
‚öôÔ∏è Processando 1762 registros...
‚úÖ Processados 1762 registros v√°lidos para inser√ß√£o
   ‚Ü≥ Lote 1: 1762 registros processados.
‚úÖ Movement importado. Total processado (Insert/Update): 1762
üîÑ Atualizando Materialized Views...
üöÄ [PID 1022647] Iniciando Sorocaba_Refrescos_door_statuses.csv (DoorEvent)...
üöÄ Iniciando importa√ß√£o para DoorEvent...
‚öôÔ∏è Processando 2451 registros...
‚úÖ Processados 2451 registros v√°lidos para inser√ß√£o
   ‚Ü≥ Lote 1: 2451 registros processados.
‚úÖ DoorEvent importado. Total processado (Insert/Update): 2451
üîÑ Atualizando Materialized Views...
üöÄ [PID 1022647] Iniciando Sorocaba_Refrescos_users.xlsx (User)...
üöÄ Iniciando importa√ß√£o para User...
‚öôÔ∏è Processando 264 registros...
‚úÖ Processados 264 registros v√°lidos para inser√ß√£o
   ‚Ü≥ Lote 1: 264 registros processados.
‚úÖ User importado. Total processado (Insert/Update): 264
üöÄ [PID 1022644] Iniciando ABI_Brasil_alerts.xlsx (Alert)...
üöÄ Iniciando importa√ß√£o para Alert...
‚öôÔ∏è Processando 1 registros...
‚úÖ Processados 1 registros v√°lidos para inser√ß√£o
   ‚Ü≥ Lote 1: 1 registros processados.
‚úÖ Alert importado. Total processado (Insert/Update): 1
üîÑ Atualizando Materialized Views...
üöÄ [PID 1022644] Iniciando ABI_Brasil_users.xlsx (User)...
üöÄ Iniciando importa√ß√£o para User...
‚öôÔ∏è Processando 4690 registros...
‚úÖ Processados 4690 registros v√°lidos para inser√ß√£o
   ‚Ü≥ Lote 1: 4690 registros processados.
‚úÖ User importado. Total processado (Insert/Update): 4690
üöÄ [PID 1022644] Iniciando Fogel_de_Centroamerica,_S.A._movements.xlsx (Movement)...
üöÄ Iniciando importa√ß√£o para Movement...
‚öôÔ∏è Processando 0 registros...
‚úÖ Processados 0 registros v√°lidos para inser√ß√£o
‚ö†Ô∏è Nenhum registro v√°lido para importar.
üöÄ [PID 1022644] Iniciando Fogel_de_Centroamerica,_S.A._users.xlsx (User)...
üöÄ Iniciando importa√ß√£o para User...
‚öôÔ∏è Processando 3 registros...
‚úÖ Processados 3 registros v√°lidos para inser√ß√£o
   ‚Ü≥ Lote 1: 3 registros processados.
‚úÖ User importado. Total processado (Insert/Update): 3
üöÄ [PID 1022644] Iniciando Redbull_alerts.xlsx (Alert)...
üöÄ Iniciando importa√ß√£o para Alert...
‚ùå Erro na importa√ß√£o de Alert: Excel file format cannot be determined, you must specify an engine manually.
üöÄ [PID 1022644] Iniciando Redbull_door_statuses.csv (DoorEvent)...
üöÄ Iniciando importa√ß√£o para DoorEvent...
‚ö†Ô∏è Nenhuma coluna correspondente encontrada no arquivo docs/Redbull_door_statuses.csv
   Colunas encontradas: ['{"errors":null', 'info:"Session has expired!"', 'data:null', 'combos:{}', 'moreInfo:null']...
üöÄ [PID 1022644] Iniciando Redbull_health_events.xlsx (HealthEvent)...
üöÄ Iniciando importa√ß√£o para HealthEvent...
‚ùå Erro na importa√ß√£o de HealthEvent: Excel file format cannot be determined, you must specify an engine manually.
üöÄ [PID 1022644] Iniciando Redbull_movements.xlsx (Movement)...
üöÄ Iniciando importa√ß√£o para Movement...
‚ùå Erro na importa√ß√£o de Movement: Excel file format cannot be determined, you must specify an engine manually.
üöÄ [PID 1022644] Iniciando Redbull_users.xlsx (User)...
üöÄ Iniciando importa√ß√£o para User...
‚ùå Erro na importa√ß√£o de User: Excel file format cannot be determined, you must specify an engine manually.
üöÄ [PID 1022644] Iniciando Sorocaba_Refrescos_alerts.xlsx (Alert)...
üöÄ Iniciando importa√ß√£o para Alert...
‚öôÔ∏è Processando 14 registros...
‚úÖ Processados 14 registros v√°lidos para inser√ß√£o
   ‚Ü≥ Lote 1: 14 registros processados.
‚úÖ Alert importado. Total processado (Insert/Update): 14
üîÑ Atualizando Materialized Views...
üöÄ [PID 1022646] Iniciando ABI_Brasil_health_events.xlsx (HealthEvent)...
üöÄ Iniciando importa√ß√£o para HealthEvent...
‚öôÔ∏è Processando 515 registros...
‚úÖ Processados 515 registros v√°lidos para inser√ß√£o
   ‚Ü≥ Lote 1: 515 registros processados.
‚úÖ HealthEvent importado. Total processado (Insert/Update): 515
üîÑ Atualizando Materialized Views...
üöÄ [PID 1022646] Iniciando Sorocaba_Refrescos_health_events.xlsx (HealthEvent)...
üöÄ Iniciando importa√ß√£o para HealthEvent...
‚öôÔ∏è Processando 4541 registros...
‚úÖ Processados 4541 registros v√°lidos para inser√ß√£o
   ‚Ü≥ Lote 1: 4541 registros processados.
‚úÖ HealthEvent importado. Total processado (Insert/Update): 4541
üîÑ Atualizando Materialized Views...
üöÄ [PID 1022645] Iniciando ABI_Brasil_door_statuses.csv (DoorEvent)...
üöÄ Iniciando importa√ß√£o para DoorEvent...
‚öôÔ∏è Processando 507 registros...
‚úÖ Processados 507 registros v√°lidos para inser√ß√£o
   ‚Ü≥ Lote 1: 507 registros processados.
‚úÖ DoorEvent importado. Total processado (Insert/Update): 507
üîÑ Atualizando Materialized Views...
üöÄ [PID 1022645] Iniciando Fogel_de_Centroamerica,_S.A._alerts.xlsx (Alert)...
üöÄ Iniciando importa√ß√£o para Alert...
‚öôÔ∏è Processando 0 registros...
‚úÖ Processados 0 registros v√°lidos para inser√ß√£o
‚ö†Ô∏è Nenhum registro v√°lido para importar.
üöÄ [PID 1022645] Iniciando Fogel_de_Centroamerica,_S.A._door_statuses.csv (DoorEvent)...
üöÄ Iniciando importa√ß√£o para DoorEvent...
‚öôÔ∏è Processando 0 registros...
‚úÖ Processados 0 registros v√°lidos para inser√ß√£o
‚ö†Ô∏è Nenhum registro v√°lido para importar.
üöÄ [PID 1022645] Iniciando Fogel_de_Centroamerica,_S.A._health_events.xlsx (HealthEvent)...
üöÄ Iniciando importa√ß√£o para HealthEvent...
‚öôÔ∏è Processando 11 registros...
‚úÖ Processados 11 registros v√°lidos para inser√ß√£o
   ‚Ü≥ Lote 1: 11 registros processados.
‚úÖ HealthEvent importado. Total processado (Insert/Update): 11
üîÑ Atualizando Materialized Views...
üöÄ [PID 1022645] Iniciando Sorocaba_Refrescos_movements.xlsx (Movement)...
üöÄ Iniciando importa√ß√£o para Movement...
‚öôÔ∏è Processando 5258 registros...
‚úÖ Processados 5258 registros v√°lidos para inser√ß√£o
   ‚Ü≥ Lote 1: 5000 registros processados.
   ‚Ü≥ Lote 2: 258 registros processados.
‚úÖ Movement importado. Total processado (Insert/Update): 5258
üîÑ Atualizando Materialized Views...
‚úÖ ABI_Brasil_alerts.xlsx: Sucesso. (Arquivo deletado)
‚úÖ ABI_Brasil_door_statuses.csv: Sucesso. (Arquivo deletado)
‚úÖ Fogel_de_Centroamerica,_S.A._alerts.xlsx: Sucesso. (Arquivo deletado)
‚úÖ Fogel_de_Centroamerica,_S.A._door_statuses.csv: Sucesso. (Arquivo deletado)
‚úÖ ABI_Brasil_users.xlsx: Sucesso. (Arquivo deletado)
‚úÖ Fogel_de_Centroamerica,_S.A._movements.xlsx: Sucesso. (Arquivo deletado)
‚úÖ Fogel_de_Centroamerica,_S.A._users.xlsx: Sucesso. (Arquivo deletado)
‚ùå Redbull_alerts.xlsx: Falha. Falha na importa√ß√£o gen√©rica
‚ùå Redbull_door_statuses.csv: Falha. Falha na importa√ß√£o gen√©rica
‚ùå Redbull_health_events.xlsx: Falha. Falha na importa√ß√£o gen√©rica
‚ùå Redbull_movements.xlsx: Falha. Falha na importa√ß√£o gen√©rica
‚ùå Redbull_users.xlsx: Falha. Falha na importa√ß√£o gen√©rica
‚úÖ ABI_Brasil_movements.xlsx: Sucesso. (Arquivo deletado)
‚úÖ ABI_Brasil_health_events.xlsx: Sucesso. (Arquivo deletado)
‚úÖ Fogel_de_Centroamerica,_S.A._health_events.xlsx: Sucesso. (Arquivo deletado)
‚úÖ Sorocaba_Refrescos_door_statuses.csv: Sucesso. (Arquivo deletado)
‚úÖ Sorocaba_Refrescos_users.xlsx: Sucesso. (Arquivo deletado)
‚úÖ Sorocaba_Refrescos_alerts.xlsx: Sucesso. (Arquivo deletado)
‚úÖ Sorocaba_Refrescos_health_events.xlsx: Sucesso. (Arquivo deletado)
‚úÖ Sorocaba_Refrescos_movements.xlsx: Sucesso. (Arquivo deletado)

‚è±Ô∏è  Tempo total: 47.67 segundos
üìä Resumo: 15/20 arquivos importados com sucesso

üîÑ Atualizando Materialized Views finais...
‚úÖ Materialized Views atualizadas.

[2025-12-11 10:02:44] ‚úì Scraping conclu√≠do com sucesso
[2025-12-11 10:02:44] ============================================
[2025-12-11 10:02:44] Scraping di√°rio finalizado
[2025-12-11 10:02:44] ============================================
